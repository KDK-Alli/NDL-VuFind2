<?php if ($recs = $this->recommend->getRecommendations()): ?>
  <!-- START of: finna - Recommend/Ontology.phtml -->
  <?php foreach ($recs as $type => $typeRecs): ?>
    <?php foreach ($typeRecs as $term => $termRecs): ?>
      <div class="ontology-recommendation ontology-<?= $type ?> alert alert-info" data-result-type="<?= $type ?>" data-term="<?= $term ?>">
        <p><?= $this->transEsc(
          'ontology_recommendation_' . $type,
          ['%%term%%' => $term, '%%results_count%%' => count($termRecs)]
        ) ?>
        <?php if (1 === count($termRecs)): ?>
          <a href="<?= $termRecs[0]['href'] ?>" data-key="<?= $termRecs[0]['cookieKey'] ?>" data-value="<?= $termRecs[0]['cookieValue'] ?>">'<?= $termRecs[0]['label'] ?>'</a>
          </p>
        <?php else: ?>
          </p>
          <ul<?php if (count($termRecs) > 5):?> class="truncate-field" data-rows="1"<?php endif;?>>
            <?php foreach ($termRecs as $termRec): ?>
              <li><a href="<?= $termRec['href'] ?>" data-key="<?= $termRec['cookieKey'] ?>" data-value="<?= $termRec['cookieValue'] ?>"><?= $termRec['label'] ?></a></li>
            <?php endforeach; ?>
          </ul>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>
  <?php endforeach; ?>
  <?php
    $script = <<<EOT
    $('.ontology-recommendation a').each(function() {
      $(this).click(function() {
        finna.common.setCookie($(this).data('key'), $(this).data('value'));
      });
    });
EOT;
    echo $this->inlineScript(\Laminas\View\Helper\HeadScript::SCRIPT, $script, 'SET');
  ?>
  <!-- END of: finna - Recommend/Ontology.phtml -->
<?php endif; ?>
