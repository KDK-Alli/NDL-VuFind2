<!-- START of: finna - RecordDriver/DefaultRecord/record-video-player.phtml -->
<div class="video-accordion">
  <?php $i = 0; ?>
  <?php foreach ($videoUrls as $url): ?>
    <div class="video-item">
      <?php 
        $description = $url['desc'] ?? $this->truncateUrl($url['url']);
        $embeddedVideo = $this->recordLink()->getEmbeddedVideo($url['url']);
        $desc = $embeddedVideo === 'data-embed-iframe' ? $this->translate('format_Video') : $description;

        $first = ($i === 0);
        $id = 'video-container-' . $i;
        $ariaExpanded = 'aria-expanded=' . (($first) ? 'true' : 'false');
        $posterUrl = isset($url['posterUrl']) && !empty($url['posterUrl']) ? $url['posterUrl'] : '';
        $dataEmbed = !empty($url['embed']) && $url['embed'] === 'video' ? ' data-embed-video' : '';

        $attrs = [];
        $attrs['link'] = 'href=' . $this->escapeHtmlAttr($this->proxyUrl($url['url']));
        $attrs['title'] = 'title=' . $this->escapeHtmlAttr($url['url']);
        $attrs['target'] = 'target="_blank"';
        $attrs['embeddedUrl'] = $embeddedVideo;
        $attrs['dataEmbed'] = $dataEmbed;
        $attrs['posterImage'] = 'data-poster-image=' . $this->escapeHtmlAttr($posterUrl);

        if (!empty($url['videoSources'])) {
          $attrs['sources'] = 'data-video-sources=' . $this->escapeHtmlAttr(json_encode($url['videoSources']));
        }
      ?>
      <button type="button" aria-label="video" class="video-link-title <?=($first) ? '' : 'collapsed'?>" data-toggle="collapse" data-target="#<?=$id?>" <?=$ariaExpanded?>>
        <i class="fa fa-play-circle"></i>
        <span><?=$this->escapeHtml($desc)?></span>
        <span class="caret"></span>
      </button>
      <div role="figure" class="video-link-container <?=($first) ? 'collapse in' : 'collapse'?>" id="<?=$id?>" <?=$ariaExpanded?>>
        <a class="videourl fulltext" <?=implode(' ', array_values($attrs))?>>
          <div class="video-icon"><i class="fa fa-play-circle"></i></div>
        </a>
      </div>
    </div>
    <?php $i++ ?>
  <?php endforeach; ?>
</div>
<div class="clearfix"></div>
<!-- END of: finna - RecordDriver/DefaultRecord/record-video-player.phtml -->
