<!-- START of: finna - RecordDriver/DefaultRecord/holdings.phtml -->
<?php
  $dedupData = $this->driver->getDedupData();
  $deduplicated = count($dedupData) > 1;
?>

<div class="holding-details<?=$deduplicated ? ' deduplicated' : ''?>">
  <?php
  /* Display information on duplicate records if available */
  $recordSource = $this->driver->tryMethod('getDataSource');

  if ($deduplicated): ?>
    <div class="dedupInformation">
      <select class="dedup-select form-control" aria-haspopup="true" title="<?=$this->transEsc('select_dedup_organisation');?>" aria-label="<?=$this->transEsc('select_dedup_organisation');?>">
        <?php foreach ($dedupData as $source => $current): ?>
          <option value="<?=$this->escapeHtmlAttr($current['id']) ?>" class="dedup-data-id" data-source="<?=$this->escapeHtmlAttr($source) ?>"<?php if ($recordSource === $source): ?> selected="selected"<?php endif; ?>><?=$this->transEsc("source_$source", null, $source) ?></option>
        <?php endforeach; ?>
      </select>
    </div>
  <?php elseif ($recordSource): ?>
    <div class="dedupInformation">
      <strong><?=$this->transEsc("source_$recordSource", null, $recordSource) ?></strong>
    </div>
  <?php endif; ?>

  <div class="callnumAndLocation ajax-availability<?=$this->driver->supportsAjaxStatus() ? ' hidden' : ''?>">
    <div class="availability-load-indicator hidden"><i class="fa fa-spinner fa-spin"></i> <?=$this->transEsc('Loading')?>...<br/></div>
    <?php if ($this->driver->supportsAjaxStatus()): ?>
      <strong class="hideIfDetailed"></strong>
      <span class="callnumber ajax-availability hidden">
      </span>
      <span class="location ajax-availability hidden">
      </span>
      <div class="locationDetails clearfix"></div>
    <?php else: ?>
      <?php $summCallNo = $this->driver->getCallNumber(); if (!empty($summCallNo)): ?>
        <strong><?=$this->transEsc('Call Number')?>:</strong> <?=$this->escapeHtml($summCallNo)?>
      <?php endif; ?>
    <?php endif; ?>
    <?php if (!($recordType = $this->driver->tryMethod('getRecordType')) || !in_array($recordType, ['ead', 'forward', 'lido'])): ?>
      <div class="no-holdings<?=$this->driver->supportsAjaxStatus() ? ' hidden' : ''?>">
        <?=$this->transEsc('No Holdings Available')?>
      </div>
    <?php endif; ?>
  </div>
</div>
<!-- END of: finna - RecordDriver/DefaultRecord/holdings.phtml -->
