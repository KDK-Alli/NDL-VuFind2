<? //Don't add START and END comments ?>
<? if (!empty($data)): ?>
  <? foreach ($data as $field): ?>
    <?/* Depending on the record driver, $field may either be an array with
       "name" and "number" keys or a flat string containing only the series
       name.  We should account for both cases to maximize compatibility. */?>
    <? if (is_array($field)): ?>
      <? if (!empty($field['name'])): ?>
        <a href="<?=$this->record($this->driver)->getLink('series', $field['name'])?>"><?=$this->escapeHtml($field['name'])?></a><? if (!empty($field['issn']) || !empty($field['number']) || !empty($field['partName']) || !empty($field['partNumber'])): ?>, <? endif; ?>
        <? if (!empty($field['issn'])): ?>
          ISSN <?=$this->escapeHtml($field['issn'])?><? if (!empty($field['number'])): ?>; <? endif; ?>
        <? endif; ?>
        <? if (!empty($field['number'])): ?>
          <?=$this->escapeHtml($field['number'])?><? if (!empty($field['partName']) || !empty($field['partNumber'])): ?>, <? endif; ?>
        <? endif; ?>
        <? if (!empty($field['partName']) && !empty($field['partNumber'])): ?>
          <? $link = $field['partName']." & ".$field['partNumber']; ?><br/>
          <a href="<?=$this->record($this->driver)->getLink('series', $link)?>"><?=$this->escapeHtml($link)?></a>
        <? elseif (!empty($field['partName']) && empty($field['partNumber'])): ?>
          <?=$this->escapeHtml($field['partName']) ?>
        <? elseif (empty($field['partName']) && !empty($field['partNumber'])): ?>
          <?=$this->escapeHtml($field['partNumber']) ?>
        <? endif; ?>
        <br/>
      <? endif; ?>
    <? else: ?>
      <a href="<?=$this->record($this->driver)->getLink('series', $field)?>"><?=$this->escapeHtml($field)?></a><br/>
    <? endif; ?>
  <? endforeach; ?>
<? endif; ?>
